好的，这是关于“8.5 总线结构”的学习笔记：

## 8.5 总线结构

计算机系统中采用的总线结构有**单总线结构**和**多总线结构**。

### *8.5.1 单总线结构

*   早期的计算机采用单总线结构方式。
*   将 CPU、主存和 I/O 模块都挂接在一个总线上。
*   CPU 与主存、CPU 与 I/O 模块、主存与 I/O 模块之间的传送都通过同一组总线进行。
*   **图 8.12 单总线结构**
* ![[image-360.png]]
  
*   **代表机型**：PDP-11 和国产 DJS183 机。

*   **优点**：
    *   结构简单。
    *   便于扩充。

*   **缺点**：
    *   所有传送都共享一组总线，极易使总线成为整个系统的**瓶颈**。
    *   一个总线上某一时刻只能有一对设备进行传输，所有设备只能**分时共享**总线。
    *   **性能下降因素**：
        *   **设备数量增多**：总线上连接的设备越多，传输延迟就会越大。
        *   **频繁的控制信号传递**：当控制信号频繁地从一个设备传递到另一个设备时，这种传输延迟会明显地影响性能。
        *   **数据传输需求量和速度要求提高**：随着计算机应用领域的扩大，挂接在系统中的外设种类和数量越来越多，对数据传输的速度要求也越来越高，单总线方式性能会急剧下降。
    *   **解决方法 (有限)**：可以通过增加总线宽度和提高总线的时钟频率来解决总线瓶颈问题。
    *   **根本性问题**：当总线上挂接了大量的高速设备 (如视频和图形控制器、LAN 控制器等) 后，单一总线就再也无法满足系统的要求了。
    *   **需求驱动**：需要既能为键盘、Modem 等这些慢速设备传送数据，也能为高速设备传送数据，而且要把 CPU 从数据传送操作中解放出来。

*   **发展方向**：采用多总线结构，并根据数据传输的不同要求采用分层次的总线结构。

### *8.5.2 双总线结构

在单总线的基础上再开辟一条 CPU 与主存之间的通路，形成以主存储器为中心的双总线结构。

*   **(a) 以主存为中心的双总线结构** (图 8.13a)
	* ![[image-361.png]]
    *   CPU 与主存间的通路称为**主存总线**。
        *   该总线速度较高。
        *   由于只在主存与 CPU 之间传输信息，因而速度快，效率高。
    *   同时，它又减轻了**系统总线**的负担。
    *   并且保证主存与 I/O 之间也能直接传送，而不需通过 CPU。
    *   **代表机型**：国产 DJS184 机。

*   **(b) 采用 IOP 方式的双总线结构** (图 8.13b)
	* ![[image-362.png]]
    *   主要用在采用输入输出处理器 (IOP) 方式进行 I/O 传送的计算机系统中。
    *   **基本思想**：将 I/O 设备从单总线分离出来，将原先的单总线分成**主存总线**和 **I/O 总线**。
    *   **信息传送路径**：
        *   CPU、主存和输入输出处理器之间的信息传送在**主存总线**上进行。
        *   各种 I/O 设备与主机 (通过 IOP) 之间的信息交换通过 **I/O 总线**和**主存总线**进行。
    *   **输入输出处理器 (IOP)**：一种专门用于进行输入输出控制的特殊处理器，它将 CPU 中大部分 I/O 控制任务接管过来，从而具有对各种 I/O 设备进行统一管理的功能。
    *   **结构特点**：是一种**分层的总线结构**。
    *   **优点**：通过 IOP 将 CPU 和 I/O 分离开来，减轻了 CPU 参与 I/O 而带来的负担。
    *   **外设连接**：一般这种结构的系统会将不同特性的外设分类挂接在输入输出处理器的不同通道上。


### 8.5.3 多总线结构

*   如果在上述以主存为中心的双总线结构中，将 I/O 设备和主存从系统总线上分离出来，将原先的系统总线分成**主存总线**和 **I/O 总线**。而在主存和高速的磁盘等设备之间引入一个专门的 **DMA 总线**，那么系统可构造成一种**三总线结构** (图 8.14)。
    *   **主存总线**：用于 CPU 和主存之间的信息传送。
    *   **I/O 总线**：用于 CPU 和各个 I/O 之间进行信息传输。
    *   **DMA 总线**：用于高速外设和主存之间的信息交换。
    *   **注意**：在这种三总线结构中，DMA 总线和主存总线不能同时用于访问主存。
    *   **图 8.14 早期的三总线结构**
    ![[image-363.png]]

*   **传统的总线结构 (三级总线结构)** (图 8.15)
    *   采用**处理器-cache 总线 (局部总线)**、**主存总线 (系统总线)**、**I/O 总线 (扩展总线)** 三级总线结构。
    *   **处理器-cache 总线 (局部总线)**：处理器和高速缓存之间通过专门的局部总线相连，并且可将其他靠近 CPU 的局部设备连接到该总线。
    *   **主存总线 (系统总线)**：高速缓存同时还与主存储器一起连接到主存总线上，它们之间通过主存总线进行数据传输。
    *   **扩展 I/O 总线**：这种结构引入了一条或多条扩展 I/O 总线 (如 ISA、EISA、MCA 总线等)。
    *   **连接方式**：主存总线和扩展 I/O 总线上 I/O 设备之间的数据传送可以通过**扩展总线接口**来缓冲。
    *   **优点**：这种设置使得系统能够支持更广泛的 I/O 设备，并且将 I/O 设备和主存间的通信与处理器的活动隔离开来。
    *   **图 8.15 传统的三级总线结构**
        ![[image-364.png]]

*   **改进的多级总线结构 (针对高性能外设)** (图 8.16)
* ![[image-365.png]]
    *   图 8.15 所示总线结构在 I/O 设备性能都相差不大的情况下比较有效。
    *   **问题**：随着计算机技术和应用水平的不断提高，cache 已经做在 CPU 中，并且大量高性能外设不断涌现。高速的视频图形设备、LAN 和 SCSI 设备等如果还和低速的串行接口、打印机等连在同一个总线上的话，那么势必会影响系统的效率。
    *   **典型做法**：在主存总线和扩充 I/O 总线之间引入一种**高速总线** (如 VL 总线、PCI 总线等)，将那些高速的块传送设备挂接在这种高速总线上。而低速 I/O 设备仍然由扩充 I/O 总线支持。
    *   **图 8.16 改进的多级总线结构**
        *   CPU <---(处理器总线)---> 桥接器 <---(主存总线)---> 主存
        *   桥接器 <---(高速 I/O 总线)---> SCSI, LAN, 图形设备
        *   高速 I/O 总线 <---> 扩展总线接口 <---(低速 I/O 总线)---> Modem, FAX, 串口

*   **现代典型的多总线结构 (基于奔腾 4 处理器)** (图 8.17)
    *   反映了处理器总线、存储器总线、PCI 总线以及外设接口 (AGP 接口、USB 接口、ATA 接口、串口 COM 及并口 LPT) 连接 CPU、主存和各种外设的连接关系。
    *   **特点**：越靠近 CPU 的总线越快，越远离 CPU 的总线越慢。
    *   **图 8.17 典型的 Pentium 4 系统总线结构** (简要示意)
        ![[image-366.png]]