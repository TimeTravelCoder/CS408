
计算机系统是一个复杂的系统，为了更好地理解和管理这种复杂性，通常采用层次化的方式来描述和组织它。不同的用户由于其在计算机上完成任务的不同，所看到的和需要关注的计算机层面也不同。
**一、用户分类**
按照在计算机上完成任务的不同，可以把使用计算机的用户分成以下4类：
1.  **最终用户 (End User)**：
    *   定义：使用应用程序完成特定任务的计算机用户。
    *   特点：大多数计算机使用者都属于最终用户。
    *   举例：使用炒股软件的股民、玩计算机游戏的人、进行会计电算化处理的财会人员等。

2.  **系统管理员 (System Administrator)**：
    *   定义：利用操作系统等软件提供的功能对系统进行配置、管理和维护，以建立高效合理的系统环境供计算机用户使用的操作人员。
    *   职责：主要包括安装、配置和维护系统的硬件和软件，建立和管理用户账户，升级软件，备份和恢复业务系统和数据等。
3.  **应用程序员 (Application Programmer)**：
    *   定义：使用高级编程语言编制应用软件的程序员。
4.  **系统程序员 (System Programmer)**：
    *   定义：设计和开发系统软件的程序员。
    *   举例：开发操作系统、编译器、数据库管理系统等系统软件的程序员。
**二、不同用户眼中的计算机 (计算机系统的层次化体现)**
计算机系统采用层次化体系结构，不同用户工作在不同层次，他们所看到的计算机系统是不一样的。
**1.4.1 最终用户眼中的计算机**
*   **交互方式**：主要通过键盘、鼠标等外设与计算机交互。
*   **感知层面**：
    *   **操作系统提供的用户界面**：如图形用户界面 (GUI) 或命令行界面 (CLI)，用于启动执行应用程序或系统命令。
    *   **安装在计算机中的相关应用程序**：如办公软件、浏览器、游戏等。
*   **认知特点**：对计算机底层的硬件和复杂的系统软件细节通常不了解，只关心如何使用应用程序完成任务。
*   **历史对比**：早期的计算机非常昂贵，只能由少数专业化人员使用。随着20世纪80年代初个人计算机的迅速普及以及20世纪90年代初多媒体计算机的广泛应用，特别是互联网技术的发展，计算机已成为人们日常生活中的重要工具。应用场景非常广泛，如播放电影、玩游戏、炒股票、发邮件、查信息、聊天打电话等。
**1.4.2 系统管理员眼中的计算机**
*   **交互与感知层面**：
    *   **系统中部分硬件层面**：需要了解硬件的配置和连接。
    *   **软硬件配置和系统管理层面**：需要熟悉操作系统的安装、配置和管理功能。
    *   **相关的实用程序和人机交互界面**：用于执行管理任务。
*   **认知特点**：相对于普通最终用户，系统管理员对计算机系统的了解要深入得多。他们需要解决很多普通用户解决不了的问题。
*   **核心需求**：必须能够安装、配置和维护系统的硬件和软件，能建立和管理用户账户，需要时能升级硬件和软件，备份和恢复业务系统和数据等。
**1.4.3 应用程序员眼中的计算机**
*   **编程工具**：大多使用高级程序设计语言 (High-Level Programming Language) 编写程序。
    *   **高级语言定义**：指面向算法设计的、较接近于日常所用的英语书面语言的程序设计语言。
    *   **举例**：BASIC, C, Fortran, Java 等。
*   **感知层面**：
    *   **计算机硬件** (抽象层面，非底层细节)
    *   **操作系统提供的编程接口 (API, Application Programming Interface)**
    *   **人机交互界面**
    *   **实用程序**
    *   **相应的程序语言处理系统**：
        *   **翻译程序 (Compiler/Interpreter)**
        *   **编辑程序 (Editor)**
        *   **链接程序 (Linker)**
        *   **装入程序 (Loader)**
        *   **集成开发环境 (Integrated Development Environment, IDE)**：将上述程序和工具集成在一起。
        *   **各类函数库 (Libraries)**：可供应用程序调用的预编译代码。
*   **认知特点**：关注如何利用编程语言和开发工具来构建应用程序，与硬件的直接交互较少，主要通过操作系统和API。
**1.4.4 系统程序员眼中的计算机**
*   **工作内容**：开发操作系统、编译器和实用程序等系统软件。
*   **交互层面**：
    *   需要熟悉计算机底层的相关硬件和系统结构。
    *   甚至可能需要直接与计算机硬件和指令系统打交道。
    *   例如，直接对各种控制寄存器、用户可见寄存器、I/O接口等硬件进行控制和编程。
*   **认知层面**：
    *   必须熟悉**指令系统 (Instruction Set)**、**机器结构 (Machine Organization)** 和相关的机器功能特性。
    *   有时还要直接用**汇编语言 (Assembly Language)** 等低级程序设计语言编写程序代码。
*   **计算机系统结构 / 指令集体系结构 (Instruction Set Architecture, ISA)**：
    *   **定义**：通常把系统程序员感觉到的计算机的功能特性和概念性结构称为计算机系统结构或指令集体系结构。
    *   **内容包括**：
        *   数据类型及格式
        *   指令系统及指令格式
        *   寻址方式和可访问空间大小
        *   程序可访问的寄存器个数、位数和编号
        *   控制寄存器的定义
        *   I/O空间的编址方式
        *   中断结构
        *   机器工作状态的定义和切换
        *   输入输出连接结构和数据传送方式
        *   存储保护方式等。
    *   **重要性**：这些都是系统程序员为了使编写的系统软件能在机器上正确执行而需要了解和遵循的计算机属性。

**1.4.5 程序开发与执行过程 (体现层次化结构)**
程序的开发和执行涉及计算机系统的各个不同层面，因而计算机系统层次化结构的思想体现在程序开发与执行过程的各个环节中。

*   **以简单的 "hello.c" C语言源程序为例**：
    ```c
    1 #include <stdio.h>
    2
    3 int main ()
    4 {
    5   printf ("hello, world\n");
    6 }
    ```

*   **应用程序员的开发步骤**：
    1.  **(1) 编辑源程序**：通过程序编辑软件得到 `hello.c` 文件。
        *   `hello.c` 在计算机中以 **ASCII 字符**方式存放 (如图1.7所示，图中给出了每个字符对应的ASCII码的十进制值)。
    2.  **(2) 编译链接过程 (如图1.8 `hello.c` 源程序文件到可执行代码文件的转换过程)**：将 `hello.c` 进行预处理、编译、汇编和链接，最终生成可执行代码文件。
	    * ![[image-103.png]]
        *   **预处理程序 (CPP, C Preprocessor)**：处理如 `#include` 等预处理指令，生成 `hello.i` (预处理过的源程序，文本文件)。
        *   **编译程序 (CC1, Compiler)**：将 `hello.i` 翻译成汇编语言源程序 `hello.s` (文本文件)。
        *   **汇编程序 (as, Assembler)**：将 `hello.s` 翻译成可重定位目标程序 `hello.o` (二进制文件)。此例中，`printf` 函数在另外的 `printf.o` 文件中。
        *   **链接程序 (ld, Linker)**：将 `hello.o` 和 `printf.o` (以及其他必要的库文件) 合并，并解决地址重定位问题，最终生成可执行目标程序 `hello` (二进制文件)。

*   **计算机执行程序的过程**：
    *   **指令 (Instruction)**：计算机的控制器自动执行的是指令。每条指令由**操作码 (Opcode)** 和**地址码 (Address Code)** 两部分组成。操作码指出操作类型，地址码指出操作数的地址。
    *   **程序执行**：实际上是执行一个指令序列。
    *   **语言转换**：不管用什么高级语言编写的程序都必须转换为一个指令序列才能在计算机上执行。
    *   **指令集 (Instruction Set) / 机器语言 (Machine Language)**：
        *   定义：计算机能直接执行的指令的集合。
        *   特点：指令由二进制编码构成，由指令构成的程序文件是二进制文件 (binary file)。如图1.8中的 `hello.o`、`printf.o` 和 `hello` 都是二进制文件。
    *   **可重定位目标文件 (Relocatable Object File)**：由单独的源程序文件转换得到，每个目标文件中指令和数据所用的地址都在各自独立的地址空间中。
    *   **链接 (Linking)**：链接程序将关联的多个目标程序连接生成可执行文件时，通过重定位指令和数据来将多个目标文件结合为一个整体，共享一个共同的地址空间。
    *   **汇编语言 (Assembly Language)**：
        *   定义：机器语言的符号表示语言。通过用简短的英文符号和二进制代码建立对应关系，以方便程序员编写和阅读机器语言程序。
        *   特点：面向计算机硬件，与计算机系统结构密切相关，属于低级语言。
    *   **程序设计语言处理系统 (Language Processing System)**：
        *   定义：进行高级语言源程序/汇编语言源程序到机器语言程序转换的软件统称。
        *   通常，应用程序员和系统程序员都借助它来开发软件。
    *   **翻译程序 (Translator)**：
        *   定义：任何一个语言处理系统中都包含一个翻译程序，它能把一种编程语言表示的程序转换为等价的另一种编程语言程序。
        *   **源语言 (Source Language)** 和 **源程序 (Source Program)**：被翻译的语言和程序。
        *   **目标语言 (Target Language)** 和 **目标程序 (Target Program)**：翻译生成的语言和程序。
        *   **文本文件 (Text File)**：通常把用ASCII码字符或汉字字符表示的文件称为文本文件，一般源程序文件都是文本文件 (如图1.8中的 `hello.c`, `hello.i`, `hello.s`)。
    *   **翻译程序的类型**：
        *   **(1) 汇编程序 (Assembler)**：也称汇编器，用来将汇编语言源程序翻译成机器语言目标程序。
        *   **(2) 解释程序 (Interpreter)**：也称解释器，用来将源程序中的语句按其执行顺序逐条翻译成机器指令并立即执行。不生成目标程序。例如，某些BASIC解释程序。
        *   **(3) 编译程序 (Compiler)**：也称编译器，用来将高级语言源程序翻译成汇编语言或机器语言目标程序。

*   **不同层次语言的描述 (如图1.9 不同层次语言之间的等价转换)**：
	* ![[image-104.png]]
    *   **高级语言源程序** (例如：`temp = v[k]; v[k] = v[k+1]; v[k+1] = temp;`)
        *   直观，易于理解。
    *   **汇编语言源程序** (例如：`lw $15, 0($2)` ; `lw $16, 4($2)` ; `sw $16, 0($2)` ; `sw $15, 4($2)`)
        *   `lw` (load word) 是装入指令，`sw` (store word) 是存储指令。
        *   符号化表示，比机器码易读，但仍需了解指令集。
    *   **机器语言目标程序** (例如：`1000 1100 0100 1111 0000 0000 0000 0000`)
        *   特定格式的二进制代码，计算机能直接识别和执行。
    *   **硬件执行层面**：
        *   **指令译码器 (Instruction Decoder)**：将机器指令的操作码译码。
        *   **控制信号 (Control Signals)**：控制器根据译码结果生成控制信号 (如 `EXTop=1, ALUSelA=1, ALUSelB=11, ALUop=add, IorD=1, Read, MemtoReg=1, RegWr=1,...`) 来控制数据通路执行。
    *   **层次关系**：
        *   `计算机软件层`: 高级语言 -> (编译程序) -> 汇编语言 -> (汇编程序) -> 机器语言
        *   `计算机硬件层`: 机器语言 -> (指令译码器 + 控制器) -> 控制信号 -> 数据通路操作

*   **透明性 (Transparency)**：
    *   定义：在计算机技术中，一个存在的事物或概念从某个角度看似不存在，称为透明性现象。
    *   **举例**：通常，在一个计算机系统中，系统程序员所看到的底层机器级的概念性结构和功能特性对高级语言程序员 (通常就是应用程序员) 来说是透明的，也即看不见的。
    *   **原因**：因为对应用程序员来说，他们直接用高级语言编程，不需要了解有关汇编语言的编程问题，也不用了解机器语言中规定的指令格式、寻址方式、数据类型和格式等指令系统方面的问题。

*   **总结：计算机系统的层次化结构 (如图1.10 计算机系统的层次化结构)**：
	* ![[image-105.png]]
    *   一个计算机系统可以认为是由各种硬件和各类软件采用层次化方式构建的分层系统。
    *   不同用户工作在不同的系统结构层，所看到的计算机的概念性结构和功能特性是不同的。
    *   **最顶层：最终用户 (Applications层)** - 应用程序
    *   **高级语言虚拟机层 (High-Level Language Virtual Machine)** - 应用程序员 (编译程序/解释程序)
    *   **汇编语言虚拟机层 (Assembly Language Virtual Machine)** - 汇编语言程序员 (汇编程序)
    *   **操作系统虚拟机层 (Operating System Virtual Machine)** - 系统管理员 (操作系统)
    *   **指令集体系结构 (ISA) / 机器语言机器层 (Machine Language Machine)** - 系统程序员
        *   这是硬件和软件的交界面，是整个计算机系统中的核心部分。
        *   硬件所有的功能都由ISA集中体现，软件通过ISA在计算机上执行。
    *   **硬件实现层 (Hardware Implementation Level)**：
        *   **微体系结构层 / 数字设计层 (Microarchitecture / Digital Design)**：CPU、主存、I/O等功能部件通过数字逻辑电路设计实现。
        *   **电路设计层 (Circuit Design)**：门电路、触发器等。
        *   **物理器件层 (Device Physics)**：晶体管等。
    *   **ISA层面以下的交互**：
        *   系统程序员看到的机器属性属于ISA层面，看到的机器是配置了指令系统的机器，称为机器语言机器。
        *   系统管理员工作在操作系统层，看到的是配置了操作系统的虚拟机器，称为操作系统虚拟机。
        *   汇编语言程序员工作在提供汇编程序的虚拟机器级，看到的机器称为汇编语言虚拟机。
        *   应用程序员大多工作在提供编译器或解释器等翻译程序的语言处理系统层，看到的虚拟机器称为高级语言虚拟机。

---