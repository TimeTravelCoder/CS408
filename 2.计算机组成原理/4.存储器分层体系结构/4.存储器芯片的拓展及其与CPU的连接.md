受集成度和功耗等因素的限制，单个芯片的容量不可能很大。因此，往往通过存储器芯片的扩展技术，将多个芯片做在一个内存模块上，然后由多个内存模块以及主板或扩充板上的RAM芯片和ROM芯片组成一台计算机所需的主存空间，再通过系统总线和CPU相连。
![[image-160.png]]
*   **内存条和插槽**：图4.13(a)是内存条和内存条插槽(slot)的示意图。
*   **连接关系**：图4.13(b)是存储控制器(Memory Controller)、存储器总线、内存条和DRAM芯片之间的连接关系示意图。

**4.4.1 存储器芯片的扩展**
由若干个存储器芯片构成一个存储器时，需要在字方向和位方向上进行扩展。
1.  **位扩展 (字长扩展)**
    *   **目的**：用若干片位数较少的存储器芯片构成给定字长的存储器。
    *   **方法**：
        *   各芯片的地址线并联。
        *   各芯片的读写控制线（如片选CS、读/写WE）并联。
        *   各芯片的数据线分别引出，共同构成所需字长的数据总线。
    *   **示例**：用8片4096×1位的芯片构成4K×8位的存储器，需要在位方向上扩展8倍，字方向上无须扩展。
2.  **字扩展 (容量扩展)**
    *   **目的**：用若干片容量较小的存储器芯片构成给定容量的存储器，位数不变。
    *   **方法**：
        *   各芯片的地址线（低位部分）并联。
        *   各芯片的数据线并联。
        *   各芯片的读写控制线（如WE）并联。
        *   各芯片的片选信号(CS)则分别由外部译码器的不同译码输出端控制，以选择不同的芯片。
    *   **示例**：用4片16K×8位的存储芯片在字方向上扩展4倍，构成一个64K×8位的存储器。
3.  **字、位同时扩展**
    *   **目的**：当芯片在容量和位数都不满足存储器要求的情况下，需要对字和位同时进行扩展。
    *   **方法**：综合位扩展和字扩展的方法。
    *   **示例**：用16K×4位的存储芯片在字方向上扩展4倍、位方向上扩展两倍，可构成一个64K×8位的存储器。
    *   **DRAM芯片扩展示例 (图4.14)**：用8个16M×8位的DRAM芯片扩展构成一个128MB主存。
	    * ![[image-161.png]]
        *   每片DRAM芯片内部存储阵列为4096×4096×8位，行、列地址各12位，有8个位平面，每次读写8位。
        *   芯片中每一行有4096列，每列有8位。
        *   操作：选中某一行并读出到行缓冲后，再由列地址选择其中的一列（8个二进位）送到存储控制器，组合成需要的传输宽度（如64位），再通过存储器总线进行传输。

**4.4.2 存储器芯片与CPU的连接**

在CPU与存储器芯片连接时，需考虑以下几方面的问题：

1.  **CPU的负载能力**：当存储器芯片较多时，需在CPU与存储器芯片之间增加必要的缓冲和驱动电路。
2.  **速度匹配问题**：存储器芯片的存取速度与CPU相比有很大差距，设计连接线路时要考虑速度匹配。
3.  **多片存储芯片的选通**：在CPU和存储芯片之间需增加外部译码电路，产生片选信号，保证在不同地址范围内访问不同的芯片。
4.  **读写控制信号**：CPU的读写控制信号不一定与存储芯片引脚定义的控制信号相符，有时需要增加附加线路来实现正确控制。

**连接的具体方面：**

1.  **地址线的连接**
    *   CPU地址线数决定整个主存空间的寻址范围，一般比存储芯片的地址引脚线多。
    *   **连续编址时**：CPU地址线的低位与存储芯片地址线相连，高位地址用作字扩展时的片选信号译码。
    *   **交叉编址时**：CPU地址线的低位用作片选信号译码。

2.  **数据线的连接**
    *   CPU数据线数决定一次可读写的最大数据宽度，也往往比单个存储芯片的数据线多。
    *   通常将CPU数据线连接到多个进行位扩展的芯片中，使扩展后的位数与CPU数据线数相等。

3.  **控制线的连接**
    *   **读写命令线**：若CPU读写命令线和存储芯片的读写控制线都是一根且控制电平信号一致，则可直接相连；若分开，则需分别连接。
    *   **访存请求信号 (MREQ)**：CPU中的MREQ信号用来确定访问的是主存还是I/O端口。只有要求访问主存（MREQ信号有效，如低电平）时才需要选择存储芯片。因此，存储芯片的片选信号CS与MREQ信号有关。
    *   **片选信号**：部分地址线也与片选信号有关，用于选择具体的芯片。

**存储器区域划分与芯片选择：**

*   在选择存储芯片类型和数量时，必须先确定好ROM区和RAM区的地址范围。
*   **ROM区**：通常存放系统加电时用于系统引导的一组程序（如加电自检、系统配置、自举装入、底层设备驱动、底层中断服务等）。应选用ROM芯片构造。
*   **RAM区**：通常存放操作系统内核和用户程序。应选用RAM芯片构造。

**例4.1：存储器设计示例**
  
*   **条件**：
    *   CPU地址线：A₁₅~A₀ (16位)
    *   CPU数据线：D₇~D₀ (8位)
    *   控制信号：WR (读写控制)，MREQ (访存请求)
    *   地址分配：
        *   0000H~3FFFH：系统引导程序区 (ROM区)
        *   4000H~FFFFH：操作系统内核和用户程序区 (RAM区)
    *   可用芯片：8K×4位的ROM芯片，16K×8位的RAM芯片
    *   要求：按字节编址，说明地址译码方案，连接ROM、RAM芯片与CPU。
*   **分析与解**：
    *   CPU寻址能力：2¹⁶ = 64KB，地址空间0000H~FFFFH。
    *   **ROM区 (0000H~3FFFH)**：
        *   大小：3FFFH - 0000H + 1 = 4000H = 16KB。
        *   ROM区高两位地址 (A₁₅A₁₄) 总是00。低14位 (A₁₃~A₀) 进行全译码。
        *   所需ROM芯片数：(16K×8位) / (8K×4位) = 2 (字扩展) × 2 (位扩展) = 4片。
        *   ROM芯片内部地址线：13位 (A₁₂~A₀)，连接到CPU的A₁₂~A₀。
        *   片选逻辑：CPU的A₁₃用于ROM芯片的字扩展选择。
    *   **RAM区 (4000H~FFFFH)**：
        *   大小：FFFFH - 4000H + 1 = C000H = 48KB。
        *   RAM区高两位地址 (A₁₅A₁₄) 分别是01, 10, 11。低14位 (A₁₃~A₀) 进行全译码。
        *   所需RAM芯片数：(48K×8位) / (16K×8位) = 3片 (字扩展)，位方向不需扩展。
        *   RAM芯片内部地址线：14位 (A₁₃~A₀)，连接到CPU的A₁₃~A₀。
        *   片选逻辑：CPU的A₁₅A₁₄用于RAM芯片的字扩展选择。
    *   **连接图**：参考图4.15，其中涉及到译码器（如74LS138）根据MREQ、A₁₅、A₁₄、A₁₃等产生各芯片的片选信号。ROM芯片数据线需要两两并联再接到CPU数据总线，RAM芯片数据线直接并联。所有芯片的WR、MREQ（经过逻辑组合）及相应的地址线连接。
   ![[image-162.png]]
	（请注意，图4.15中的译码器具体连接细节未在文字中详述，实际连接时需要根据所选译码器逻辑功能和地址分配来设计。）