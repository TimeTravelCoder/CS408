存储器是计算机系统的重要组成部分，用来存放程序和数据。计算机通过存储器实现记忆能力，能自动地从存储器中取出指令并按序执行。计算机中使用的记忆元件有多种类型，如寄存器、静态RAM、动态RAM、磁盘、磁带、光盘等，它们具有不同的速度、容量和价格。这些存储器按照层次化方式构成了存储器分层体系结构。
**4.1.1 存储器的分类**
根据存储器的特点和使用方法的不同，可以有以下几种分类方法：
1.  **按存储元件分类**
    *   存储元件必须具有两个截然不同的物理状态，用以表示二进制代码0和1。
    *   **半导体存储器**：用半导体器件构成的存储器。
    *   **磁表面存储器**：主要指用磁性材料构成的存储器，如磁盘存储器和磁带存储器。
    *   **光盘存储器**：用光介质构成的存储器。
2.  **按存取方式分类**
    *   **(1) 随机存取存储器 (Random Access Memory, RAM)**
        *   特点：按地址访问存储单元。每个地址译码时间相同，因此在不考虑芯片内部缓冲的前提下，每个单元的访问时间是一个常数，与地址无关。
        *   注意：现代DRAM芯片内部具有行缓冲，可能因数据已在缓冲而缩短访问时间。
        *   应用：半导体存储器属于随机存取存储器，可用作cache和主存储器。
    *   **(2) 顺序存取存储器 (Sequential Access Memory, SAM)**
        *   特点：信息按顺序存放和读出，其存取时间取决于信息存放位置。以记录块为单位编址。
        *   例子：磁带存储器。特点是存储容量大，但存取速度慢。
    *   **(3) 直接存取存储器 (Direct Access Memory, DAM)**
        *   特点：存取方式兼有随机访问和顺序访问的特点。首先可直接选取所需信息所在区域，然后按顺序方式存取。
        *   例子：磁盘存储器。
    *   **(4) 相联存储器 (Content Addressed Memory, CAM 或 Associative Memory)**
        *   特点：不是按地址访问，而是按内容检索到存储位置进行读写。当不知道所访问信息的地址，只知道内容特征时使用。
        *   例子：快表。
3.  **按信息的可更改性分类**
    *   **读写存储器 (Read/Write Memory)**：信息可以读出和写入。RAM芯片是读写存储器。
    *   **只读存储器 (Read Only Memory, ROM)**：信息一旦确定，通常情况下只读不写，但在某些情况下也可重新写入。
    *   注意：RAM芯片和ROM芯片都采用随机存取方式进行信息的访问。
4.  **按断电后信息的可保存性分类**
    *   **非易失性 (不挥发) 存储器 (Nonvolatile Memory)**：信息可一直保留，不需电源维持。
        *   例子：ROM、磁表面存储器、光存储器等。
    *   **易失性 (挥发) 存储器 (Volatile Memory)**：电源关闭时信息自动丢失。
        *   例子：RAM、cache等。
5.  **按功能分类**
    *   **(1) 高速缓冲存储器 (cache)**
        *   构成：目前由静态RAM (SRAM) 芯片组成。
        *   位置：位于主存和CPU之间。
        *   特点：存取速度接近CPU的工作速度。
        *   用途：存放当前CPU经常使用到的指令和数据。
    *   **(2) 主存储器 (主存, Main Memory)**
        *   定义：指令直接面向的存储器。CPU执行指令时给出的存储器地址是主存地址（虚拟存储系统中需转换逻辑地址）。
        *   地位：存储器分层体系结构中的核心存储器。
        *   用途：存放系统中被启动运行的程序及其数据。
        *   构成：目前一般用MOS管半导体存储器构成。
    *   **(3) 辅助存储器 (辅存)**
        *   定义：系统运行时直接和主存交换信息的存储器。
        *   例子：磁盘存储器相对于磁带和光盘速度快，目前多用磁盘存储器作为辅存。
        *   访问：辅存的內容需要调入主存后才能被CPU访问。
    *   **(4) 海量后备存储器**
        *   构成：磁带存储器和光盘存储器。
        *   特点：容量大、速度慢。
        *   用途：主要用于信息的备份和脱机存档。
    *   **统称**：辅存和海量后备存储器统称为外部存储器（外存）。
---
**4.1.2 主存储器的组成和基本操作**
*   **核心部分**：存储阵列（存储体/存储矩阵），由记忆单元 (cell/存储元/位元) 构成。每个记忆单元是能表示二进制0和1的物理器件。
*   **编址单位 (Addressing Unit)**：具有相同地址的那些位元构成的一个单位，可以是一个字节或一个字。
*   **编址方式 (Addressing Mode)**：对各存储单元进行编号的方式，可按字节编址或按字编址。
    *   **字节编址**：大多数通用计算机采用，存储体内一个地址中有一个字节。
    *   **64位编址**：许多专用于科学计算的大型计算机采用，因为科学计算中数据多为64位浮点数。
*   **基本操作（参照图4.1 主存储器基本框图）**：
	* ![[image-146.png]]
    *   **地址寄存器 (MAR, Memory Address Register)**：CPU将访问单元的地址送到MAR。
    *   **数据寄存器 (MDR, Memory Data Register)**：CPU通过MDR与主存交换数据。
    *   **地址线**：将MAR中的地址送到主存中的地址译码器。
    *   **数据线**：在MDR和主存之间传送数据。
    *   **读写控制信号/控制线**：CPU通过控制线将读写信号送到主存的读写控制电路。
    *   **写操作**：CPU将待写信息送MDR，地址送MAR，发出写命令，信息经数据线写入选中单元。
    *   **读操作**：CPU将地址送MAR，发出读命令，主存读出选中单元内容送数据线，再送到MDR。
*   **相关宽度**：数据线的宽度与MDR的宽度相同，地址线的位数（宽度）与MAR的宽度相同。地址线位数决定最大可寻址范围。
**4.1.3 存储器的主要性能指标**
评价存储器性能的主要指标：容量、速度和价格。
*   **容量**：指能存放的二进制位数或字（字节）数。
*   **价格**：
    *   总价格 C。
    *   每位价格 c = C/S (S为按位计算的容量)。
    *   总价C应包括存储单元本身及外围电路的价格。
*   **速度**：
    *   **访问时间 (Access Time)**：
        *   **读出时间 (TA)**：从存储器接到读命令开始至信息被送到数据线上所需的时间。
        *   **写入时间 (TW)**：从存储器接到写命令开始至信息被写入存储器所需的时间。
    *   **存储周期 (Memory Cycle Time, TM)**：存储器进行一次读写操作所需要的全部时间，即连续两次独立读写操作允许的最短间隔时间。等于访问时间加上恢复时间。一般有 TM > TA，TM > TW。
    *   **存储器带宽 (B)**：存储器被连续访问时，可以提供的数据传送速率，通常用每秒传送信息的位数（或字节数）来衡量。
*   **技术发展趋势**：
    *   容量：过去10年大致每两年翻一番。
    *   价格：每年约35%速度下降。
    *   访问延迟：每年约7%速度提高 (例如DDR SDRAM访问延时约10ns-20ns)。
    *   传输带宽：DDR2 SDRAM单芯片数据带宽可达600-800MBps，存储模块数据带宽可达5-6GBps。
---
**4.1.4 存储器的层次化结构**
*   **背景**：
    *   存储器容量和性能应随处理器速度和性能提高而同步提高，以保持系统性能平衡。
    *   过去20多年，处理器和存储器在性能发展上的差异越来越大，存储器（尤其在容量和访问延时方面）性能增长跟不上处理器。
    *   单一元件制造的存储器很难同时满足大容量、高速度和低成本的要求。
*   **目的**：缩小存储器和处理器在性能方面的差距。
*   **方法**：在计算机内部采用层次化的存储器体系结构。将各种不同容量和不同存取速度的存储器按一定结构组织起来。
*   **原理**：程序和数据按不同的层次存放在各级存储器中，整个存储系统在速度、容量和价格等方面具有较好的综合性能指标。
* ![[image-147.png]]
*   **典型层次结构 (自顶向下，速度递减，容量递增，每位价格递减，离CPU渐远)**：
    *   **寄存器** (CPU内部)
    *   **高速缓存 cache** (通常为SRAM)
    *   **主存储器** (RAM和ROM，通常为DRAM)
        *   以上三者合称 **内部存储器**，CPU可直接访问。
    *   **辅助存储器** (如硬盘)
    *   **海量后备存储器** (如磁带库、光盘库)
        *   以上两者合称 **外部存储器** (外存)，其信息需先调入主存才能被CPU访问。
*   **特点**：图4.2中给出的典型存取时间和存储容量会随时间变化，但反映了速度和容量之间的关系以及层次化结构存储器的构成思想。