好的，这是关于“4.5 并行存储器结构技术”部分的学习笔记：

**4.5 并行存储器结构技术**

由于CPU和主存所使用的半导体器件工艺不同，两者速度上的差距导致快速的CPU常常需要等待慢速的主存储器。为了提高主存的速度，可以从以下三个方面考虑：

1.  提高DRAM芯片本身的速度（如前述的各种基于SDRAM的技术）。
2.  采用并行结构技术，利用时间并行和空间并行性在结构上进行优化（本节介绍的双口存储器和多模块存储器）。
3.  在CPU和主存之间增加高速缓冲存储器 (cache)（将在4.6节介绍）。

**4.5.1 双口存储器 (Dual-Port Memory)**

*   **定义**：双口存储器是在一个存储器中提供两组独立的读写控制电路和两个读写端口。
*   **特点**：可以同时提供两个数据的并行读写，是一种空间并行技术。
*   **逻辑结构 (图4.16)**：
	* ![[image-163.png]]
    *   每个读写口都有一套独立的地址缓存器和译码电路。
    *   两套电路并行独立工作。
    *   **无冲突访问**：当A、B两个端口地址不相同时，可以向存储体一次读写两个单元的内容。
    *   **冲突访问**：当A、B两个端口地址相同时，发生冲突，可按照特定的优先顺序选择其中一个端口进行读写。
*   **应用**：
    *   用作通用寄存器组 (GRS) 或指令预取部件。
    *   一些计算机将双口RAM设计成一个端口面向CPU，另一个端口面向输入输出设备（如I/O处理器或DMA设备）。
    *   用于多机系统中，实现双口或多口存储器与多CPU之间的信息交换。

**4.5.2 多模块存储器**

*   **定义**：多模块存储器是一种空间并行技术，利用多个结构完全相同的存储模块的并行工作来增加存储器的吞吐率。
*   **特点**：
    *   每个存储模块具有相同的容量和存取速度。
    *   每个存储模块各自具有独立的地址寄存器MAR、数据寄存器MDR、地址译码器、驱动电路和读写电路，因此它们能独立并行工作。
*   **编址方式**：根据不同的编址方式，多模块存储器分为连续编址和交叉编址两种结构。

1.  **连续编址方式 (高位交叉/顺序编址)**
    *   **地址划分**：主存地址的高位表示模块号（或体号），低位表示模块内地址（或体内地址）。
    *   **特点**：地址在模块内是连续的。
	    ![[image-164.png]]
    *   **示意图 (图4.17)**：存储器共有4个模块M₀~M₃，每个模块有n个单元。M₀的地址范围为0~n-1，...，M₃的地址范围为3n~4n-1。
    *   **访问过程**：总是把低位的体内地址送到由高位体号所确定的模块内进行译码。
    *   **性能**：
        *   当访问一个连续主存块时（如cache缺失时取一块数据），总是先在一个模块内访问，等到该模块全部单元访问完才转到下一个模块。
        *   现代计算机通常有cache，CPU总是先访问cache。在cache缺失时，再去访问主存，将一个主存块内连续单元的信息取到cache。
        *   **提高吞吐率的场景**：如果CPU访问主存的同时，DMA控制器正控制外设和另一个存储模块之间实现数据传输操作，那么这两个存储模块可独立并行工作，此时连续编址方式能提高存储器的吞吐率。
        *   **一般情况**：若CPU大多只访问单个存储模块，则不能提高存储器的吞吐率。

2.  **交叉编址方式 (低位交叉)**
    *   **地址划分**：主存地址的低位表示模块号（或体号），高位表示模块内地址（或体内地址）。
    *   **特点**：地址在多个模块之间交叉分布。
    *   **模块编址**：每个模块按“模m”交叉方式编址。假定有m个模块体，每个体有k个单元。
        *   第0, m, ..., (k-1)m 单元位于第0模块。
        *   第1, m+1, ..., (k-1)m+1 单元位于第1模块。
        *   ...
        *   第m-1, 2m-1, ..., km-1 单元位于m-1号模块。
    *   **模块数m**：一般取2的方幂，这样硬件电路比较简单。有些机器为了减少存储器冲突，采用质数个模块（如我国银河机取m=31，硬件实现较复杂）。
    *   **示意图 (图4.18)**：模4交叉编址方式存储器示意图。
	    * ![[image-165.png]]
    *   **访问过程**：总是把高位的体内地址送到由低位体号所确定的模块内进行译码。
    *   **性能 (采用顺序轮流启动方式)**：
        *   例如，若每隔1/m个存储周期 (Tм) 启动一个体，则每隔1/m个存储周期就可读出或写入一个数据，存取速度提高m倍。
        * ![[image-166.png]]
        *   **图4.19 (四体交叉访问时间关系)**：负脉冲为启动每个体的信号。每个体的存储周期并没有缩短，但由于交叉访问各体，在一个存储周期内向CPU提供了4个存储字。若每个模块的存储字为32位，则在一个存储周期内向CPU提供了32×4=128位信息，因而大大提高了存储器的带宽。
        *   **适用场景**：
            *   CPU对一个主存块中的连续单元进行访问（如cache缺失）。
            *   DMA传送将一块连续主存单元与高速设备进行数据交换。
            *   此时，可同时存取多个存储模块，因而可提高访存速度。

总结：并行存储器结构技术，特别是交叉编址的多模块存储器，能够有效地提高存储系统的带宽，从而缓解CPU与主存之间的速度瓶颈。